{"id":"Nexflow-36v","title":"1.2 Конфигурация","description":"Реализовать систему конфигурации с поддержкой YAML, JSON и ENV переменных.\n\n## Задачи:\n- [ ] Создать структуру конфигурации (struct)\n- [ ] Реализовать парсер YAML\n- [ ] Реализовать парсер JSON\n- [ ] Создать пример `config.yml` и `config.json`\n- [ ] Реализовать загрузку из ENV переменных\n\n## Приемка:\n- Конфигурация загружается из YAML/JSON\n- ENV переменные подставляются в конфиг (${VAR})\n- Пример конфига создан в `examples/config.yml`\n\n## Пример config.yml:\n```yaml\nserver:\n  host: \"127.0.0.1\"\n  port: 8080\n\ndatabase:\n  type: \"sqlite\"\n  path: \"./data/nexflow.db\"\n\nllm:\n  default_provider: \"openai\"\n  providers:\n    anthropic:\n      api_key: \"${ANTHROPIC_API_KEY}\"\n      model: \"claude-opus-4\"\n    openai:\n      api_key: \"${OPENAI_API_KEY}\"\n      model: \"gpt-4\"\n    ollama:\n      base_url: \"http://localhost:11434\"\n      model: \"llama3\"\n    gemini:\n      api_key: \"${GEMINI_API_KEY}\"\n      model: \"gemini-pro\"\n    zai:\n      api_key: \"${ZAI_API_KEY}\"\n      model: \"glm-4\"\n    openrouter:\n      api_key: \"${OPENROUTER_API_KEY}\"\n      model: \"anthropic/claude-3-opus\"\n    custom:\n      base_url: \"${CUSTOM_LLM_URL}\"\n      api_key: \"${CUSTOM_LLM_KEY}\"\n      model: \"custom-model\"\n\nchannels:\n  telegram:\n    bot_token: \"${TELEGRAM_BOT_TOKEN}\"\n    allowed_users: []\n  web:\n    enabled: true\n\nskills:\n  directory: \"./skills\"\n  timeout_sec: 30\n  sandbox_enabled: true\n\nlogging:\n  level: \"info\"\n  format: \"json\"\n```","status":"closed","priority":0,"issue_type":"task","owner":"AATumaykin@tsum.ru","created_at":"2026-01-29T20:40:37.347964+03:00","created_by":"Александр Тумайкин","updated_at":"2026-01-29T21:09:53.120904+03:00","closed_at":"2026-01-29T21:09:53.120904+03:00","close_reason":"Реализована система конфигурации:\n- Создана структура Config с необходимыми полями\n- Реализована функция Load() для парсинга YAML и JSON\n- Добавлена подстановка ENV переменных ()\n- Реализована валидация конфигурации\n- Созданы unit-тесты, все проходят\n- Созданы примеры конфигов (examples/config.yml и config.json)\n- go build успешен","labels":["config","infrastructure"],"dependencies":[{"issue_id":"Nexflow-36v","depends_on_id":"Nexflow-3oq","type":"parent-child","created_at":"2026-01-29T20:42:01.888165+03:00","created_by":"Александр Тумайкин"},{"issue_id":"Nexflow-36v","depends_on_id":"Nexflow-ejb","type":"blocks","created_at":"2026-01-29T20:42:04.017293+03:00","created_by":"Александр Тумайкин"}]}
{"id":"Nexflow-3oq","title":"Фаза 1: Базовая инфраструктура","description":"Первая фаза разработки Nexflow - создание базовой инфраструктуры проекта.\n\nЭта фаза включает:\n- Настройку проектной структуры Go проекта\n- Реализацию системы конфигурации\n- Создание схемы базы данных и ORM\n- Настройку системы логирования\n\n**Срок:** 1 неделя\n\n**Зависимости:**\n- Nexflow-ejb: Проектная структура (P0)\n- Nexflow-36v: Конфигурация (P0)\n- Nexflow-ixc: База данных (P0)\n- Nexflow-gtu: Логирование (P1)\n\n## Приемка фазы:\n- Все P0 задачи завершены\n- Проект собирается без ошибок\n- Конфигурация загружается корректно\n- База данных инициализируется\n- Логи пишутся в JSON формате","status":"open","priority":0,"issue_type":"epic","owner":"AATumaykin@tsum.ru","created_at":"2026-01-29T20:41:38.678313+03:00","created_by":"Александр Тумайкин","updated_at":"2026-01-29T20:41:38.678313+03:00","labels":["infrastructure","phase-1"]}
{"id":"Nexflow-ejb","title":"1.1 Проектная структура","description":"Создать Go проект с модулями и настроить структуру директорий.\n\n## Задачи:\n- [ ] Создать Go проект с модулями\n- [ ] Настроить структуру директорий: `cmd/`, `internal/`, `pkg/`, `skills/`, `docs/`\n- [ ] Инициализировать Go modules\n- [ ] Настроить CI/CD (GitHub Actions)\n\n## Приемка:\n- Go modules инициализированы в go.mod\n- Все директории созданы\n- GitHub Actions workflow настроен","status":"closed","priority":0,"issue_type":"task","owner":"AATumaykin@tsum.ru","created_at":"2026-01-29T20:40:25.025864+03:00","created_by":"Александр Тумайкин","updated_at":"2026-01-29T21:06:19.21315+03:00","closed_at":"2026-01-29T21:06:19.21315+03:00","close_reason":"Завершено: Go проектная структура создана, все критерии приёмки выполнены","labels":["go","infrastructure"],"dependencies":[{"issue_id":"Nexflow-ejb","depends_on_id":"Nexflow-3oq","type":"parent-child","created_at":"2026-01-29T20:41:41.457291+03:00","created_by":"Александр Тумайкин"}]}
{"id":"Nexflow-gtu","title":"1.4 Логирование","description":"Настроить структурированную систему логирования с поддержкой JSON формата и маскированием секретов.\n\n## Задачи:\n- [ ] Настроить структурированный logger (slog/logrus)\n- [ ] Реализовать JSON формат\n- [ ] Реализовать маскирование секретов\n- [ ] Создать логирование по уровням (DEBUG, INFO, WARN, ERROR)\n\n## Требования:\n- Логи должны быть в JSON формате для удобства парсинга\n- API ключи, токены и пароли должны маскироваться автоматически\n- Уровень логирования должен настраиваться через конфиг\n- Все события должны иметь timestamp и source\n\n## Приемка:\n- Logger интегрирован во все компоненты\n- JSON формат логов подтвержден\n- Секреты маскируются в логах\n- Уровни логирования работают корректно","status":"in_progress","priority":1,"issue_type":"task","owner":"AATumaykin@tsum.ru","created_at":"2026-01-29T20:41:33.884516+03:00","created_by":"Александр Тумайкин","updated_at":"2026-01-29T21:27:18.37573+03:00","labels":["infrastructure","logging"],"dependencies":[{"issue_id":"Nexflow-gtu","depends_on_id":"Nexflow-ejb","type":"blocks","created_at":"2026-01-29T20:41:33.8861+03:00","created_by":"Александр Тумайкин"},{"issue_id":"Nexflow-gtu","depends_on_id":"Nexflow-3oq","type":"parent-child","created_at":"2026-01-29T20:42:02.304248+03:00","created_by":"Александр Тумайкин"},{"issue_id":"Nexflow-gtu","depends_on_id":"Nexflow-ixc","type":"blocks","created_at":"2026-01-29T20:42:06.724029+03:00","created_by":"Александр Тумайкин"}]}
{"id":"Nexflow-ixc","title":"1.3 База данных","description":"Создать схему базы данных для SQLite и Postgres, реализовать ORM и миграции.\n\n## Задачи:\n- [ ] Создать SQLite схему (таблицы: users, sessions, messages, tasks, skills, schedules, logs)\n- [ ] Создать Postgres схему (для прод)\n- [ ] Реализовать Go ORM (ent/sqlc)\n- [ ] Создать миграции\n\n## Схема SQLite:\n```sql\nCREATE TABLE users (\n    id TEXT PRIMARY KEY,\n    channel TEXT NOT NULL,\n    channel_user_id TEXT NOT NULL,\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    UNIQUE(channel, channel_user_id)\n);\n\nCREATE TABLE sessions (\n    id TEXT PRIMARY KEY,\n    user_id TEXT NOT NULL,\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\nCREATE TABLE messages (\n    id TEXT PRIMARY KEY,\n    session_id TEXT NOT NULL,\n    role TEXT NOT NULL,\n    content TEXT NOT NULL,\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (session_id) REFERENCES sessions(id)\n);\n\nCREATE TABLE tasks (\n    id TEXT PRIMARY KEY,\n    session_id TEXT NOT NULL,\n    skill TEXT NOT NULL,\n    input TEXT NOT NULL,\n    output TEXT,\n    status TEXT NOT NULL,\n    error TEXT,\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (session_id) REFERENCES sessions(id)\n);\n\nCREATE TABLE skills (\n    id TEXT PRIMARY KEY,\n    name TEXT UNIQUE NOT NULL,\n    version TEXT NOT NULL,\n    location TEXT NOT NULL,\n    permissions TEXT NOT NULL,\n    metadata TEXT NOT NULL,\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE schedules (\n    id TEXT PRIMARY KEY,\n    skill TEXT NOT NULL,\n    cron_expression TEXT NOT NULL,\n    input TEXT NOT NULL,\n    enabled BOOLEAN DEFAULT 1,\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (skill) REFERENCES skills(id)\n);\n\nCREATE TABLE logs (\n    id TEXT PRIMARY KEY,\n    level TEXT NOT NULL,\n    source TEXT NOT NULL,\n    message TEXT NOT NULL,\n    metadata TEXT,\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n```\n\n## Приемка:\n- SQLite и Postgres схемы созданы\n- ORM настроен и работоспособен\n- Миграции могут применяться и откатываться\n- Есть тесты для основных операций CRUD","status":"closed","priority":0,"issue_type":"task","owner":"AATumaykin@tsum.ru","created_at":"2026-01-29T20:41:13.948177+03:00","created_by":"Александр Тумайкин","updated_at":"2026-01-29T21:26:15.827407+03:00","closed_at":"2026-01-29T21:26:15.827407+03:00","close_reason":"Завершена реализация базы данных\n\nВыполнено:\n- Создана схема базы данных (SQLite и PostgreSQL)\n- Реализован ORM на основе sqlc\n- Созданы миграции с поддержкой apply и rollback\n- Добавлены unit-тесты для всех CRUD операций\n- Поддержка SQLite (разработка) и PostgreSQL (прод)\n- Документация по конфигурации и использованию\n\nВсе критерии приёмки выполнены.","labels":["database","infrastructure"],"dependencies":[{"issue_id":"Nexflow-ixc","depends_on_id":"Nexflow-ejb","type":"blocks","created_at":"2026-01-29T20:41:13.94984+03:00","created_by":"Александр Тумайкин"},{"issue_id":"Nexflow-ixc","depends_on_id":"Nexflow-3oq","type":"parent-child","created_at":"2026-01-29T20:41:42.434694+03:00","created_by":"Александр Тумайкин"}]}
